/*! For license information please see index.js.LICENSE.txt */
(()=>{"use strict";var t={amdO:{}};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),t.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},t.r({});var e=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=++t.idx};e.idx=0;var n=e;function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t){return"object"==u(t=0<arguments.length&&void 0!==t?t:0)&&t.start?s(t.start):("string"==typeof t?t=new Date(t).getTime():t instanceof Date?t=t.getTime():"object"==u(t)?t=function(t,e,n,i,o,r,c){var l=0<arguments.length&&void 0!==t?t:-1;return t=1<arguments.length&&void 0!==e?e:-1,e=2<arguments.length&&void 0!==n?n:-1,n=3<arguments.length&&void 0!==i?i:-1,i=4<arguments.length&&void 0!==o?o:-1,o=5<arguments.length&&void 0!==r?r:-1,r=6<arguments.length&&void 0!==c?c:-1,l=parseInt(l),t=parseInt(t),e=parseInt(e),n=parseInt(n),i=parseInt(i),o=parseInt(o),r=parseInt(r),c=new Date,l=-1<l?l:c.getFullYear(),t=-1<t?t:c.getMonth()+1,e=-1<e?e:c.getDate(),n=-1<n?n:c.getHours(),i=-1<i?i:c.getMinutes(),o=-1<o?o:c.getSeconds(),r=-1<r?r:c.getMilliseconds(),new Date("".concat(l,"/").concat(t,"/").concat(e," ").concat(n,":").concat(i,":").concat(o,":").concat(r))}(t.year,t.month,t.day,t.hour,t.min,t.sec,t.msec).getTime():"number"==typeof t&&(t=(new Date).getTime()+t),t)}var a=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(e,n);var t=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=c(t);return function(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return r(t)}(this,e?(n=c(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments))}}(e);function e(n,o){var c;return i(this,e),l(r(c=t.call(this,n,o)),"clock",void 0),l(r(c),"callback",void 0),l(r(c),"name",void 0),l(r(c),"runtime",0),c.clock=o,c.callback=n,c}return e}(),f=function(){function t(e){var n=this;i(this,t),l(this,"timingTasks",{}),l(this,"taskIdx",0),l(this,"suspendId",{}),l(this,"clearId",{}),this.mainThread=function(t,e,i){for(var o in e=e.getTime(),n.timingTasks)o<=e&&(n.timingTasks[o].forEach((function(t){n.suspendId[t.id]||n.clearId[t.id]?(delete n.suspendId[t.id],delete n.clearId[t.id]):t.callback()})),delete n.timingTasks[o])},e.add(this.mainThread),this.destroy=function(){e.remove(n.mainThread)}}var e;return(e=[{key:"add",value:function(t){var e=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(Array.isArray(n))return n.map((function(n){return e.add(t,n)}));var i=s(n),o=[];return"number"==typeof i&&i==i&&"function"==typeof t&&(i=new a(t,i),void 0!==n.name&&(i.name=n.name),this.timingTasks[i.clock]=this.timingTasks[i.clock]||[],o.push(i.id),this.timingTasks[i.clock].push(i)),o}},{key:"find",value:function(t){var e,n=this;if(Array.isArray(t))return t.map((function(t){return n.find(t)})).flat(1/0).filter(Boolean);for(e in this.timingTasks){var i=this.timingTasks[e];if(i.id==t)return[i]}return[]}},{key:"reset",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return this.stop(t),this.add(e,n)}},{key:"stop",value:function(t){var e=this;this.find(t).forEach((function(t){e.clearId[t.id]=!0}))}},{key:"stopAll",value:function(){this.timingTasks={},this.suspendId={},this.clearId={}}},{key:"suspendAll",value:function(){var t,e=this;for(t in this.timingTasks)this.timingTasks[t]&&this.timingTasks[t].forEach((function(t){e.suspendId[t.id]=!0}))}},{key:"suspend",value:function(t){var e=this;this.find(t).forEach((function(t){e.suspendId[t.id]=!0}))}},{key:"continue",value:function(t){delete this.suspendId[t]}},{key:"continueAll",value:function(t){this.suspendId={}}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(t.prototype,e),t}();function d(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function b(t,e,n){return e&&m(t.prototype,e),n&&m(t,n),t}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function w(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var T=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(e,n);var t=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=k(t);return function(t,e){if(e&&("object"===y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return g(t)}(this,e?(n=k(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments))}}(e);function e(n,i){var o;return h(this,e),w(g(o=t.call(this,n,i)),"cycle",0),w(g(o),"times",1/0),w(g(o),"immediate",!1),w(g(o),"manual",!1),w(g(o),"suspending",!1),w(g(o),"absolute",!1),w(g(o),"name",void 0),w(g(o),"count",0),w(g(o),"canNext",!0),w(g(o),"callback",[]),w(g(o),"nextTime",0),w(g(o),"left",0),"function"==typeof n&&(o.callback=[n,function(){o.count++}]),o.set(i),o}return b(e,[{key:"set",value:function(t){if("number"==typeof t&&t==t)this.cycle=t;else if("object"===y(t)){var e,n=["continue","suspend","stop","next","canNext","nextTime","callback","left"];for(e in t)void 0!==t[e]&&(n.includes(e)?console.error("无法覆盖："+e):this[e]=t[e])}var i;this.left=this.immediate?0:this.cycle,this.suspending||(i=(new Date).getTime(),this.immediate?this.nextTime=i:this.nextTime=i+this.cycle)}}]),e}();function O(){console.warn("需要开启手动模式")}var j=function(){function t(e){var n=this;h(this,t),w(this,"tasks",{}),w(this,"tasksIdx",0),w(this,"idleProcess",{}),this.mainThread=function(t,e,i){for(var o in n.tasks){var r=n.tasks[o];r.suspending||(0<r.times?r.left>i?r.left=r.left-i:(r.canNext=!0,r.manual?(n.idleProcess[o]=r,delete n.tasks[o]):(c=r.absolute?r.nextTime:e.getTime(),l=e.getTime(),u=(u=r.cycle)<l-c?Math.ceil((l-c)/u):1,r.nextTime=(r.absolute?r.nextTime:e.getTime())+r.cycle*u,r.times--,r.left=r.nextTime-e.getTime()),r.callback.forEach((function(t){return t()}))):delete n.tasks[o])}var c,l,u},e.add(this.mainThread),this.destroy=function(){n.Timer.remove(n.mainThread)}}return b(t,[{key:"add",value:function(t){var e=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(Array.isArray(n))return n.map((function(n){return e.add(t,n)}));var i=this.setOption(t,n);return null!=n&&n.suspending?this.idleProcess[i.id]=i:this.tasks[i.id]=i,i.id}},{key:"reset",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return this.stop(t),this.add(e,n)}},{key:"find",value:function(t){var e=this;return(Array.isArray(t)?t.map((function(t){return e.find(t)})).flat(1/0):[this.tasks[t]||this.idleProcess[t]]).filter(Boolean)}},{key:"setOption",value:function(t){var e=this,n=new T(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0);return n.continue=function(){var t=(new Date).getTime();n.nextTime||(n.immediate?n.nextTime=t:n.nextTime=t+n.cycle),n.suspending=!1,e.tasks[n.id]=n,delete e.idleProcess[n.id]},n.suspend=function(){n.suspending=!0,e.idleProcess[n.id]=n,delete e.tasks[n.id]},n.stop=function(){e.idleProcess[n.id]&&(e.idleProcess[n.id].times=0),e.tasks[n.id]&&(e.tasks[n.id].times=0)},n.next=n.manual?function(){n.canNext&&(e.tasks[n.id]=e.idleProcess[n.id]||e.tasks[n.id],delete e.idleProcess[n.id],n.times--,n.canNext=!1,n.left=n.cycle)}:O,n.suspending&&n.suspend(),n}},{key:"continue",value:function(t){this.find(t).forEach((function(t){t.continue()}))}},{key:"continueAll",value:function(){this.continue(this.find([].concat(d(Object.keys(this.tasks)),d(Object.keys(this.idleProcess)))))}},{key:"suspend",value:function(t){this.find(t).forEach((function(t){t.suspend()}))}},{key:"suspendAll",value:function(){this.suspend(this.find([].concat(d(Object.keys(this.tasks)),d(Object.keys(this.idleProcess)))))}},{key:"stop",value:function(t){this.find(t).forEach((function(t){t.stop()}))}},{key:"stopAll",value:function(){this.tasks={},this.idleProcess={}}},{key:"next",value:function(t){this.find(t).forEach((function(t){t.next()}))}}]),t}();function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}!function(){for(var e=0,n=["webkit","moz"],i=0;i<n.length&&!t.g.requestAnimationFrame;++i)t.g.requestAnimationFrame=t.g[n[i]+"RequestAnimationFrame"],t.g.cancelAnimationFrame=t.g[n[i]+"CancelAnimationFrame"]||t.g[n[i]+"CancelRequestAnimationFrame"];t.g.requestAnimationFrame||(t.g.requestAnimationFrame=function(n){var i=(new Date).getTime(),o=Math.max(0,16.7-(i-e)),r=t.g.setTimeout((function(){n(i+o)}),o);return e=i+o,r}),t.g.cancelAnimationFrame||(t.g.cancelAnimationFrame=function(t){clearTimeout(t)})}();const P=function(){function t(){var e,n,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=[],(e="callbacks")in this?Object.defineProperty(this,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[e]=n;var o=new Date,r=o,c=o.getTime(),l=c;!function t(){r=new Date,l=r.getTime(),i.callbacks.forEach((function(t){t(o,r,l-c)})),o=r,c=l,requestAnimationFrame(t)}()}var e;return(e=[{key:"add",value:function(t){var e,n=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return A(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0;return{s:e=function(){},n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){c=!0,o=t},f:function(){try{r||null==n.return||n.return()}finally{if(c)throw o}}}}(this.callbacks);try{for(n.s();!(e=n.n()).done;)if(e.value===t)return}catch(t){n.e(t)}finally{n.f()}this.callbacks.push(t)}},{key:"remove",value:function(t){this.callbacks=this.callbacks.filter((function(e){return e!==t}))}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(t.prototype,e),t}();function x(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)),i}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){I(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function I(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E(t){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var _,D=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),I(this,"clock",null),I(this,"polling",null),I(this,"timer",null),this.timer=new P,this.clock=new f(this.timer),this.polling=new j(this.timer)}var e;return(e=[{key:"clear",value:function(t){"object"==E(t)&&t.clear&&t.clear()}},{key:"clearAll",value:function(){this.clock.stopAll(),this.polling.stopAll()}},{key:"suspend",value:function(t){"object"==E(t)&&t.suspend&&t.suspend()}},{key:"suspendAll",value:function(){this.clock.suspendAll(),this.polling.suspendAll()}},{key:"continue",value:function(t){t.clock&&this.clock.continue(t.clock),t.polling&&this.polling.continue(t.polling)}},{key:"continueAll",value:function(){this.clock.continueAll(),this.polling.continueAll()}},{key:"setTimeout",value:function(t,e){var n=this,i={},o=this.clock.add((function(){return t(i)}),e);return Object.assign(i,{clock:o,callback:t,options:e,check:function(){return n.clock.find(o)},clear:function(){n.clock.stop(o)},suspend:function(){n.clock.suspend(o)},continue:function(){n.clock.continue(o)},reset:function(i){o=n.clock.reset(o,t,void 0===i?e:i)}}),i}},{key:"setInterval",value:function(t,e){var n=this,i={},o=this.polling.add(t,e);return Object.assign(i,{polling:o,callback:t,options:e,check:function(){return n.polling.find(o)},clear:function(){n.polling.stop(o)},suspend:function(){n.polling.suspend(o)},continue:function(){n.polling.continue(o)},reset:function(i){o=n.polling.reset(o,t,void 0===i?e:i)},next:function(){n.polling.next(o)}}),i}},{key:"getClockIds",value:function(t,e){var n=this,i={};return i.polling=this.polling.add(t,S(S({absolute:!1},e),{},{immediate:!0,suspending:!0})),i.clock=this.clock.add((function(){n.polling.continue(i.polling)}),e.start),i}},{key:"setClock",value:function(t,e){if("function"!=typeof t)throw new Error("need callback");var n,i={},o=(o={start:0,cycle:0,times:1/0,immediate:!1,manual:!1},"object"==E(n=e)?o=S(S({},o),n):"number"==typeof n&&n==n?o.cycle=n:"string"==typeof n?o.start=n:"boolean"==typeof n&&(o.manual=n),o),r=this.getClockIds((function(){return t(i)}),o),c=this;return Object.assign(i,{clock:r.clock,polling:r.polling,callback:t,options:e,check:function(){return{polling:c.polling.find(r.polling),clock:c.clock.find(r.clock)}},next:function(){c.polling.next(r.polling)},clear:function(){c.clock.stop(r.clock),c.polling.stop(r.polling)},suspend:function(){c.clock.suspend(r.clock),c.polling.suspend(r.polling)},continue:function(){c.clock.continue(r.clock),c.polling.continue(r.polling)},reset:function(t){if("object"!==E(t=void 0===t?e:t))throw new TypeError("only object:\n                        {start: 0,//start time\n                        cycle: 0, //循环周期ms\n                        times: Infinity, //repeat 次数\n                        immediate: false, //立即执行\n                        manual: false,//手动开始下一次轮询\n                    }");void 0!==t.start&&c.clock.reset(t.start),c.polling.reset(t)}}),o.immediate&&t(i),i}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(t.prototype,e),t}());_=void 0,e=function(t){t.default=D,t.setTimeout=D.setTimeout.bind(D),t.setInterval=D.setInterval.bind(D),t.setClock=D.setClock.bind(D),t.clear=D.clear.bind(D),t.clearAll=D.clearAll.bind(D),t.suspend=D.suspend.bind(D),t.suspendAll=D.suspendAll.bind(D),t.continue=D.continue.bind(D),t.continueAll=D.continueAll.bind(D)},"object"===("undefined"==typeof exports?"undefined":E(exports))?e(exports):"function"==typeof define&&t.amdO?define(["exports"],e):e((_="undefined"!=typeof globalThis?globalThis:_||self).clock_polling={})})();